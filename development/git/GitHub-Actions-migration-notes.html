<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>GitHub actions and migration notes &#8212; SuperCollider Wiki  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=7d9986eb" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="git cheat sheet" href="git-cheat-sheet.html" />
    <link rel="prev" title="Git" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="github-actions-and-migration-notes">
<span id="github-actions-migration-notes"></span><h1>GitHub actions and migration notes<a class="headerlink" href="#github-actions-and-migration-notes" title="Link to this heading">¶</a></h1>
<p>This is a work-in-progress document started by Marcin with some notes about implementing our automated build system (CI/CD) using GitHub Actions (GHA). For reasons and background information on migrating to GHA see <a class="reference external" href="https://github.com/supercollider/supercollider/issues/5252">#5252</a> and <a class="reference external" href="https://github.com/supercollider/supercollider/issues/5261">#5261</a>.</p>
<section id="general-information">
<h2>General Information<a class="headerlink" href="#general-information" title="Link to this heading">¶</a></h2>
<p>GitHub Actions is configured using a <code class="docutils literal notranslate"><span class="pre">yaml</span></code> file located in <code class="docutils literal notranslate"><span class="pre">.github/workflows/&lt;name&gt;.yml</span></code></p>
<section id="gha-structure">
<h3>GHA structure<a class="headerlink" href="#gha-structure" title="Link to this heading">¶</a></h3>
<p>Workflows &gt;&gt; Jobs &gt;&gt; Steps, which use Actions</p>
<p>Events: what triggers a Workflow (e.g. push, a PR, possibly the REST API/manual trigger)</p>
<p>Runners: virtual machines with preconfigured OS images that run Jobs</p>
</section>
<section id="implementation-notes">
<h3>Implementation notes<a class="headerlink" href="#implementation-notes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>All actions for the CI are specified directly in a .yaml file; no separate scripts are used, which was the case with our Travis implementation</p></li>
<li><p>Currently we have a single .yaml file with linting, building, testing, and deployment</p></li>
<li><p>There are very minimal “dependencies” between Jobs/Steps</p>
<ul>
<li><p>We create a “version string” in the linting step</p>
<ul>
<li><p>all subsequent Jobs depend on the linting Job</p></li>
<li><p>the version string is either:</p>
<ul>
<li><p>git tag, without the <code class="docutils literal notranslate"><span class="pre">Version-</span></code> prefix, or</p></li>
<li><p>commit SHA</p></li>
</ul>
</li>
<li><p>that string is used in other Jobs/Steps, referred to as <code class="docutils literal notranslate"><span class="pre">needs.lint.outputs.sc-version</span></code>, where <code class="docutils literal notranslate"><span class="pre">lint</span></code> is the set name of the linting job, and <code class="docutils literal notranslate"><span class="pre">sc-version</span></code> is the <code class="docutils literal notranslate"><span class="pre">id</span></code> of the step that creates the string</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Test suite jobs run separately from build jobs</p>
<ul>
<li><p>they download artifacts uploaded to GHA by the building step</p></li>
<li><p>for this reason, artifact name format needs to be kept consistent for all Jobs</p>
<ul>
<li><p>if it is changed in the future, all Jobs need to be adjusted to use it (particularly testing jobs need to be updated to match the building jobs)</p></li>
<li><p>at the time of writing, the artifact name is <code class="docutils literal notranslate"><span class="pre">SuperCollider-&lt;sc-version&gt;-&lt;artifact-suffix&gt;.zip</span></code>, where <code class="docutils literal notranslate"><span class="pre">sc-version</span></code> is either tag or commit SHA, and artifact suffix is manually specified for each Job, e.g. <code class="docutils literal notranslate"><span class="pre">macOS</span></code> or <code class="docutils literal notranslate"><span class="pre">linux-bionic-gcc10</span></code></p></li>
<li><p><strong>testing and deployment actions need to match the artifact name from the building step</strong></p></li>
</ul>
</li>
<li><p>at the time of writing this, it is not possible to use matrix entries in the <code class="docutils literal notranslate"><span class="pre">depends</span> <span class="pre">on</span></code> field for Jobs, thus all tests wait for both Linux and macOS builds to finish; if possible in the future, it would be better for Linux tests to wait only on Linux builds, and macOS tests wait only on macOS builds</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="qt">
<h2>Qt<a class="headerlink" href="#qt" title="Link to this heading">¶</a></h2>
<p>Qt is not preinstalled on GitHub-provided runners. On Linux and macOS it can be installed using package managers (<code class="docutils literal notranslate"><span class="pre">apt</span></code> and <code class="docutils literal notranslate"><span class="pre">homebrew</span></code>, respectively). It can also be installed on all platforms using <code class="docutils literal notranslate"><span class="pre">install-qt-action</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">install qt using aqtinstall</span>
<span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jurplel/install-qt-action@v2</span>
<span class="w">  </span><span class="nt">with</span><span class="p">:</span>
<span class="w">    </span><span class="nt">modules</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;qtwebengine&#39;</span>
</pre></div>
</div>
<p>Note: on macOS I am currently getting <a class="reference external" href="https://github.com/supercollider/supercollider/issues/5294">issues with library paths</a> when using this method of Qt installation</p>
</section>
<section id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Link to this heading">¶</a></h2>
<p>One of the ways to debug problems with GHA is to log in via SSH to the runner while it’s running our job. This can be done using a following action:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">debug with tmate</span>
<span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mxschmitt/action-tmate@v3</span>
</pre></div>
</div>
<p>This action will allow SSH access to the runner, allowing interactive evaluation of scripts etc. Once the job reaches this step, it will post an address for SSH access (either through a browser or through a terminal). Subsequent steps are <em>not</em> being run while this action is running.</p>
<p>To continue with following steps, create an empty file with the name <code class="docutils literal notranslate"><span class="pre">continue</span></code> either in the root directory or in the project directory by running <code class="docutils literal notranslate"><span class="pre">touch</span> <span class="pre">continue</span></code> or <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">touch</span> <span class="pre">continue</span></code>.</p>
</section>
<section id="test-suite">
<h2>Test suite<a class="headerlink" href="#test-suite" title="Link to this heading">¶</a></h2>
<p>Moved to <a class="reference external" href="https://github.com/supercollider/supercollider/wiki/Continuous-Integration---GitHub-Actions#test-suite">Continuous Integration - GitHub Actions</a>.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">SuperCollider Wiki</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Development</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Git</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">GitHub actions and migration notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="git-cheat-sheet.html">git cheat sheet</a></li>
<li class="toctree-l3"><a class="reference internal" href="git-workflow-and-guidelines.html">git workflow and guidelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../meetings/index.html">Meetings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/index.html">Miscellaneous dev notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project-structure/index.html">Project structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../style/index.html">Code style guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platforms/index.html">Plattforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releasing/index.html">Releasing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reviewing/index.html">Reviewing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Development</a><ul>
  <li><a href="index.html">Git</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Git</a></li>
      <li>Next: <a href="git-cheat-sheet.html" title="next chapter">git cheat sheet</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, SuperCollider.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/development/git/GitHub-Actions-migration-notes.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>