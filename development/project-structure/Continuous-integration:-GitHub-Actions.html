<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CI: GitHub Actions &#8212; SuperCollider Wiki  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=7d9986eb" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CI: Travis and AppVeyor" href="Continuous-integration%3A-Travis-and-Appveyor.html" />
    <link rel="prev" title="Project structure" href="index.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="ci-github-actions">
<h1>CI: GitHub Actions<a class="headerlink" href="#ci-github-actions" title="Link to this heading">¶</a></h1>
<p>As of March 2021, <a class="reference external" href="https://github.com/supercollider/supercollider/wiki/GitHub-Actions-migration-notes">we have fully moved</a> our CI from Travis and AppVeyor to GitHub Actions for the main SuperCollider repository.</p>
<p>As of March 2021, sc3-plugins CI has not been moved to GitHub Actions.</p>
<p>“Continuous integration” (CI) is a practice where an application is continuously tested in a reproducible, fixed environment, and is useful to quickly detect bugs and regressions and the changes that introduce them. We have CI services for SuperCollider and sc3-plugins provided by GitHub Actions (GHA). This document is intended to provide information about this system and how we use them for people maintaining our CI integrations or interested in maintaining them.</p>
<p>Several things are checked in our CI builds:</p>
<ul class="simple">
<li><p>various dependencies can be installed reliably</p></li>
<li><p>the project can be configured correctly by CMake</p></li>
<li><p>the project builds successfully</p></li>
<li><p>tests all pass</p></li>
</ul>
<p>CI is also responsible for pushing release artifacts to GitHub (the “assets” shown in <a class="reference external" href="https://github.com/supercollider/supercollider/releases">the releases page</a>) and for pushing builds to our S3 AWS cloud storage. Builds are also accessible for a limited time directly in the Actions page.</p>
<section id="branch-vs-pr-builds">
<h2>Branch vs PR builds<a class="headerlink" href="#branch-vs-pr-builds" title="Link to this heading">¶</a></h2>
<p>Currently GitHub Actions builds are triggered for following events:</p>
<ol class="arabic simple">
<li><p>“PR”: builds the result of merging a PR, to check whether the merge is acceptable. Triggered on every update to a PR branch</p></li>
<li><p>“branch”: builds a commit in its current state. Triggered on every update to any branch in the main repository.</p></li>
</ol>
<p>A single push can trigger both a PR and branch build if the branch is in the main repo and also open as PR.</p>
<p>Important: “PR” builds don’t have access to encrypted environment variables which we use for things like access keys and IDs. Of course, it would be a major security risk otherwise. Upload to S3 is disabled for those builds.</p>
</section>
<section id="access-to-ci">
<h2>Access to CI<a class="headerlink" href="#access-to-ci" title="Link to this heading">¶</a></h2>
<p>Anyone can see the status of the GitHub Action after selecting “Actions” tab in the SuperCollider repository. Anyone with Reviewer, Trusted reviewer, or Core Team status can restart builds and modify some settings in GitHub Actions.</p>
</section>
<section id="access-to-s3">
<h2>Access to S3<a class="headerlink" href="#access-to-s3" title="Link to this heading">¶</a></h2>
<p>Our S3 storage is owned by Scott Carver. Brian Heim also has limited access.</p>
</section>
<section id="encrypted-information">
<h2>Encrypted information<a class="headerlink" href="#encrypted-information" title="Link to this heading">¶</a></h2>
<p>Sensitive information is stored in SuperCollider’s “Repository secrets”. We use this functionality for storing S3 access keys.</p>
</section>
<section id="storage-and-deployment-of-build-artifacts">
<h2>Storage and deployment of build artifacts<a class="headerlink" href="#storage-and-deployment-of-build-artifacts" title="Link to this heading">¶</a></h2>
<p>Builds produce “artifacts”, in our case dmg files, zip files and Windows installers. These are stored in 3 places:</p>
<ul class="simple">
<li><p>GitHub Action’s own storage (available for a limited time and only for authenticated GitHub users)</p></li>
<li><p>An AWS S3 instance</p></li>
<li><p>GitHub releases pages</p></li>
</ul>
<p>Brian Heim and Scott Carver have access to the S3 instance we use for storage. For info on where the S3 builds live, see <a class="reference external" href="https://github.com/supercollider/supercollider/wiki/Miscellaneous-project-information-(CI,-maintenance-scripts,-etc.)#s3-build-hosting">here</a>.</p>
<p>For SC and sc3-plugins:</p>
<ul class="simple">
<li><p>on every build of an internal branch, a DMG/ZIP macOS archive and ZIP Windows archives are deployed to S3</p></li>
<li><p>on every build of a tag, a DMG/ZIP macOS archive, Windows installers (SC) and ZIP Windows archives are deployed to the GitHub release</p></li>
</ul>
</section>
<section id="skip-ci">
<h2>[skip ci]<a class="headerlink" href="#skip-ci" title="Link to this heading">¶</a></h2>
<p>In GHA, we automatiacally skip building if the changes are made only to help files, <code class="docutils literal notranslate"><span class="pre">*.md</span></code> files, examples, and sounds. See <a class="reference external" href="https://github.com/supercollider/supercollider/blob/develop/.github/workflows/actions.yml#L10">paths-ignore section in the workflow file</a>.</p>
<p>Additionally, if you have <code class="docutils literal notranslate"><span class="pre">[skip</span> <span class="pre">ci]</span></code> in the first line of your commit message then GHA won’t build it. Please <strong>only</strong> use this functionality when a commit only changes comments, documentation files, or other text files. Do not use it when adding, deleting, or renaming files.</p>
</section>
<section id="restarting-builds">
<h2>Restarting builds<a class="headerlink" href="#restarting-builds" title="Link to this heading">¶</a></h2>
<p>If a build fails for a spurious reason and you think it will work on the next run, restart it. To to the Actions tab, open the Workflow that’s failing, and press “Re-run jobs” in the top-right section of the screen.</p>
</section>
<section id="ci-config-files">
<h2>CI config files<a class="headerlink" href="#ci-config-files" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">.github/workflows/actions.yml</span></code> is the YAML file that control configuration of GHA.</p>
</section>
<section id="linting">
<h2>Linting<a class="headerlink" href="#linting" title="Link to this heading">¶</a></h2>
<p>In first job that’s run in GHA the whole project is linted. All other builds depend on that one, so if linting fails, no actual compilation occurs. The log will print out the linting diff, which you can share with a PR author.</p>
</section>
<section id="build-steps">
<h2>Build steps<a class="headerlink" href="#build-steps" title="Link to this heading">¶</a></h2>
<p>(to be added)</p>
<p>qpm is our python test runner (github.com/supercollider/qpm), see the repo for more info.</p>
</section>
<section id="test-suite">
<h2>Test suite<a class="headerlink" href="#test-suite" title="Link to this heading">¶</a></h2>
<p>Our test suite is run using qpm, see <a class="reference external" href="https://github.com/supercollider/supercollider/pull/5332">#5332</a> for more details.</p>
<section id="which-tests-are-being-run">
<h3>Which tests are being run<a class="headerlink" href="#which-tests-are-being-run" title="Link to this heading">¶</a></h3>
<p>We use the test suite from <a class="reference external" href="https://github.com/supercollider/supercollider/tree/develop/testsuite/classlibrary">https://github.com/supercollider/supercollider/tree/develop/testsuite/classlibrary</a>. We run <em>all the tests</em>, <em>except</em> the ones excluded in <a class="reference external" href="https://github.com/supercollider/supercollider/blob/develop/testsuite/scripts/gha_test_run_proto.json">https://github.com/supercollider/supercollider/blob/develop/testsuite/scripts/gha_test_run_proto.json</a>.</p>
</section>
<section id="adding-new-tests-to-the-test-suite">
<h3>Adding new tests to the test suite<a class="headerlink" href="#adding-new-tests-to-the-test-suite" title="Link to this heading">¶</a></h3>
<p>In order to add tests to the test suite, just add them to <a class="reference external" href="https://github.com/supercollider/supercollider/tree/develop/testsuite/classlibrary">https://github.com/supercollider/supercollider/tree/develop/testsuite/classlibrary</a>. Once the changes are pushed to the repository, they will be run in GHA.</p>
</section>
<section id="removing-tests-from-the-test-suite">
<h3>Removing tests from the test suite<a class="headerlink" href="#removing-tests-from-the-test-suite" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>If the test has issues and needs to be disabled temporarily, please add an <a class="reference external" href="https://github.com/supercollider/supercollider/blob/develop/testsuite/scripts/gha_test_run_proto.json#L7">entry</a> with <code class="docutils literal notranslate"><span class="pre">&quot;skip&quot;:true</span></code> parameter to <a class="reference external" href="https://github.com/supercollider/supercollider/blob/develop/testsuite/scripts/gha_test_run_proto.json">https://github.com/supercollider/supercollider/blob/develop/testsuite/scripts/gha_test_run_proto.json</a></p></li>
<li><p>If the test is invalid for whatever reason, it should probably be removed from <a class="reference external" href="https://github.com/supercollider/supercollider/tree/develop/testsuite/classlibrary">https://github.com/supercollider/supercollider/tree/develop/testsuite/classlibrary</a></p></li>
</ul>
</section>
<section id="additional-notes">
<h3>Additional notes<a class="headerlink" href="#additional-notes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Running scsynth in GH runners is possible. On Linux one can use jack1 with dummy driver; on macOS, while audio hardware is not present, the runners have SoundFlower installed and SC server boots fine using it.</p></li>
</ul>
</section>
</section>
<section id="notes-on-migrating-from-travis-appveyor-to-github-actions">
<h2>Notes on migrating from Travis/AppVeyor to GitHub Actions<a class="headerlink" href="#notes-on-migrating-from-travis-appveyor-to-github-actions" title="Link to this heading">¶</a></h2>
<p>See <a class="reference internal" href="../git/GitHub-Actions-migration-notes.html#github-actions-migration-notes"><span class="std std-ref">GitHub Actions migration notes</span></a>.</p>
</section>
<section id="troubleshooting-tips-and-tricks">
<h2>Troubleshooting, tips and tricks<a class="headerlink" href="#troubleshooting-tips-and-tricks" title="Link to this heading">¶</a></h2>
<p>The most important thing when troubleshooting a CI issue is to check the log carefully. Sometimes, errors early on don’t manifest until much later in the build.</p>
<hr class="docutils" />
<p>If you see a failing build and can interpret the reason for the failure, do so, especially for newer contributors and when the reason for the build failing is not obvious.</p>
<hr class="docutils" />
<p>Sometimes the CI might be temporarily unavailable and not build a commit. Usually manually restarting the workflow should fix this. If not, a last resort is to push the same set of commits under a different branch name, and then make a new PR for that. For example if your branch <code class="docutils literal notranslate"><span class="pre">topic/example</span></code> is the problem:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>topic/example
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>topic/example-retry
git<span class="w"> </span>push<span class="w"> </span>-u<span class="w"> </span>origin<span class="w"> </span>topic/example-retry
</pre></div>
</div>
<p>You could also push an empty or otherwise bogus commit.</p>
<hr class="docutils" />
<p>If you have the time and patience, when you see a build failure try to see if there is a way it could have been made clearer and contribute it. There is lots of room for improvement.</p>
<hr class="docutils" />
<p>If you make a change to one of sc3-plugins or SC’s CI files, double check whether the same change should apply to the other.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">SuperCollider Wiki</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../git/index.html">Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="../meetings/index.html">Meetings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc/index.html">Miscellaneous dev notes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Project structure</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">CI: GitHub Actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Continuous-integration%3A-Travis-and-Appveyor.html">CI: Travis and AppVeyor</a></li>
<li class="toctree-l3"><a class="reference internal" href="Miscellaneous-project-information-%28CI%2C-maintenance-scripts%2C-etc.%29.html">Miscellaneous project information</a></li>
<li class="toctree-l3"><a class="reference internal" href="Notes-for-refactoring-the-server-implementation.html">Refactoring the server implementatin</a></li>
<li class="toctree-l3"><a class="reference internal" href="Project-Structure.html">Project directions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Project-directions.html">Project directions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Project-tasks-organization.html">Project tasks organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="scsynth-development.html">scsynth development</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../style/index.html">Code style guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platforms/index.html">Plattforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releasing/index.html">Releasing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reviewing/index.html">Reviewing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Development</a><ul>
  <li><a href="index.html">Project structure</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Project structure</a></li>
      <li>Next: <a href="Continuous-integration%3A-Travis-and-Appveyor.html" title="next chapter">CI: Travis and AppVeyor</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, SuperCollider.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/development/project-structure/Continuous-integration:-GitHub-Actions.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>