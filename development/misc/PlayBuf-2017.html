<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PlayBuf 2017 &#8212; SuperCollider Wiki  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=7d9986eb" />
    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Qt 5.9 info" href="Qt-5.9-info.html" />
    <link rel="prev" title="Path searching" href="Path-searching.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="playbuf-2017">
<h1>PlayBuf 2017<a class="headerlink" href="#playbuf-2017" title="Link to this heading">¶</a></h1>
<p>This page is a work in progress proposal for a new buffer player, tentatively called <code class="docutils literal notranslate"><span class="pre">XFadePlayBuf</span></code> or <code class="docutils literal notranslate"><span class="pre">PlayBufX</span></code> or <code class="docutils literal notranslate"><span class="pre">PlayBuf2</span></code>, that adds crossfading and more looping capabilities to PlayBuf. The discussion is at <a class="reference external" href="https://github.com/supercollider/supercollider/issues/2600">#2600</a>.</p>
<section id="proposal">
<h2>Proposal<a class="headerlink" href="#proposal" title="Link to this heading">¶</a></h2>
<p>The schedule is to release this UGen in sc3-plugins for 3.9 and later migrate it to core for 3.10. Given its complexity, the UGen should be thoroughly covered by unit tests and the code should be documented.</p>
<p>The UGen’s <code class="docutils literal notranslate"><span class="pre">ar</span></code> and <code class="docutils literal notranslate"><span class="pre">kr</span></code> methods shall have the following signature:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>numChannels, bufnum = 0, rate = 1, startPos = 0, startLoop = 0, endPos = -1, endLoop = -1, isLooping = 0, fadeTime = 1e-3, fadeCurve = \lin
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">numChannels</span></code>: the number of channels of the buffer provided.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bufnum</span></code>: the index of the buffer to play.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rate</span></code>: the playback rate. At <code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">1</span></code> (default), the buffer is played back at original speed, automatically applying a <code class="docutils literal notranslate"><span class="pre">BufRateScale</span></code> translation between buffer sample rate and server sample rate, if they differ. At <code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">0.5</span></code>, the buffer is played back at half speed, at <code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">2.0</span></code>, the buffer is played back at double speed. At <code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">=</span> <span class="pre">-1.0</span></code>, the playback is reversed. This can be modulated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">startPos</span></code>: sample frame position (inclusive) in the buffer where playback starts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">startLoop</span></code>: sample frame position (inclusive) in the buffer where playback resumes in loop. This can be modulated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">endPos</span></code>: sample frame position (exclusive) in the buffer where where playback ends. When <code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code> (default), the length of the buffer is used instead. This can be modulated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">endLoop</span></code>: sample frame position (exclusive) in the buffer where where looping rewinds. When <code class="docutils literal notranslate"><span class="pre">&lt;</span> <span class="pre">0</span></code> (default), the length of the buffer is used instead. This can be modulated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">isLooping</span></code>: a flag that indicates, when <code class="docutils literal notranslate"><span class="pre">&gt;</span> <span class="pre">0</span></code>, that the playback should loop. This can be modulated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fadeTime</span></code>: a cross-fade duration in seconds. This is the actual duration of the cross-fade and independent of the playback rate. The cross-fade happens at the end of the loop span, i.e. <code class="docutils literal notranslate"><span class="pre">fadeTime</span></code> seconds before <code class="docutils literal notranslate"><span class="pre">endLoop</span></code> is reached, the previous playback begins to fade out, and a new playback starting at <code class="docutils literal notranslate"><span class="pre">startLoop</span></code> begins to fade in. When <code class="docutils literal notranslate"><span class="pre">endLoop</span></code> is reached, the previous playback has completely faded out, and the new playback has completely faded in. A value of zero indicates no cross-fade. This can be modulated.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fadeCurve</span></code>: the type of curvature used for the cross-fade. This is the same as the <code class="docutils literal notranslate"><span class="pre">curve</span></code> parameter used in an <code class="docutils literal notranslate"><span class="pre">Env</span></code>. The cross-fade can be visualized as <code class="docutils literal notranslate"><span class="pre">Env([[0,</span> <span class="pre">1],</span> <span class="pre">[1,</span> <span class="pre">0]],</span> <span class="pre">[fadeTime,</span> <span class="pre">fadeTime],</span> <span class="pre">fadeCurve).plot</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">Env([[0,</span> <span class="pre">1],</span> <span class="pre">[1,</span> <span class="pre">0]],</span> <span class="pre">[1,</span> <span class="pre">1],</span> <span class="pre">\lin).plot</span></code> for a linear (equal energy) cross-fade or <code class="docutils literal notranslate"><span class="pre">Env([[0,</span> <span class="pre">1],</span> <span class="pre">[1,</span> <span class="pre">0]],</span> <span class="pre">[1,</span> <span class="pre">1],</span> <span class="pre">\welch).plot</span></code> for a square-root (equal power) cross-fade. Note that for exponential fades, where <code class="docutils literal notranslate"><span class="pre">fadeCurve</span> <span class="pre">=</span> <span class="pre">\exp</span></code>, a floor value of -60.dbamp is used instead of zero. This can be modulated.</p></li>
</ul>
<p>This UGen sets the ‘done’ flag iff <code class="docutils literal notranslate"><span class="pre">isLooping</span> <span class="pre">&gt;</span> <span class="pre">0</span></code> and the read pointer reaches <code class="docutils literal notranslate"><span class="pre">endPos</span></code>.</p>
<p>There is no <code class="docutils literal notranslate"><span class="pre">doneAction</span></code> argument. Use <code class="docutils literal notranslate"><span class="pre">Done</span></code>, <code class="docutils literal notranslate"><span class="pre">FreeSelfWhenDone</span></code>, or <code class="docutils literal notranslate"><span class="pre">PauseSelfWhenDone</span></code>.</p>
<section id="comments">
<h3>Comments<a class="headerlink" href="#comments" title="Link to this heading">¶</a></h3>
<p>when <code class="docutils literal notranslate"><span class="pre">endPos</span></code> is given at low precision, the loop duration loses precision as you increase <code class="docutils literal notranslate"><span class="pre">startLoop</span></code>. I’d suggest <code class="docutils literal notranslate"><span class="pre">loopLength</span></code> (in frames or seconds) instead. A precise duration seems more important than a precise end, because we crossfade anyway. [&#64;telephon]</p>
</section>
</section>
<section id="why-we-can-t-use-bufrd">
<h2>Why we can’t use BufRd<a class="headerlink" href="#why-we-can-t-use-bufrd" title="Link to this heading">¶</a></h2>
<p>BufRd has insurmountable precision issues if the buffer is longer than 16,777,216 frames because the <code class="docutils literal notranslate"><span class="pre">phase</span></code> input to BufRd is a float. It is impossible with the architecture of scsynth to upgrade this to a double.</p>
</section>
<section id="why-we-can-t-add-arguments-to-playbuf">
<h2>Why we can’t add arguments to PlayBuf<a class="headerlink" href="#why-we-can-t-add-arguments-to-playbuf" title="Link to this heading">¶</a></h2>
<p>Adding arguments to UGens is a dangerous practice in the era of alternate clients. If the server believes PlayBuf has eight arguments while the client believes it has seven, the client compiles a SynthDef that causes the server to read the eighth argument from garbage memory. Even if the API change is widely broadcast, we would need to live in a perfect world where all client developers are keeping up to date with SC development. You could argue that an outdated client is the client developer’s responsibility, but PlayBuf is one of the most popular UGens ever and we should be very conservative proposing changes to it.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo.svg" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">SuperCollider Wiki</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Development</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../git/index.html">Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="../meetings/index.html">Meetings</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Miscellaneous dev notes</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Adding-to-QtCollider-widgets.html">Adding QtCollider widgets</a></li>
<li class="toctree-l3"><a class="reference internal" href="Path-searching.html">Path searching</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">PlayBuf 2017</a></li>
<li class="toctree-l3"><a class="reference internal" href="Qt-5.9-info.html">Qt 5.9 info</a></li>
<li class="toctree-l3"><a class="reference internal" href="Translating-the-IDE.html">Translating the IDE</a></li>
<li class="toctree-l3"><a class="reference internal" href="Undocumented-classes-and-methods-list.html">Undocumented classes and methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../project-structure/index.html">Project structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../style/index.html">Code style guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platforms/index.html">Plattforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releasing/index.html">Releasing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reviewing/index.html">Reviewing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user/index.html">User resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community/index.html">Community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Development</a><ul>
  <li><a href="index.html">Miscellaneous dev notes</a><ul>
      <li>Previous: <a href="Path-searching.html" title="previous chapter">Path searching</a></li>
      <li>Next: <a href="Qt-5.9-info.html" title="next chapter">Qt 5.9 info</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2024, SuperCollider.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/development/misc/PlayBuf-2017.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>